@using MusicCollection.Models
@model IEnumerable<Album>

@functions {
    string FormatUrl(int page, SortType sortType) {
        return string.Format("Album?page={0}&sortType={1}", page, sortType);
    }
}

<div class="navbar navbar-fixed-top navbar-inverse" data-spy="affix">
    <div class="navbar-inner">
        <a class="brand" href="#">Music Collection</a>
        <ul class="nav">
            <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sort By
                    <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                    <li><a href="@FormatUrl(@ViewBag.Page, SortType.ArtistName)" class="dropdown-item">Artist Name</a></li>
                    <li><a href="@FormatUrl(@ViewBag.Page, SortType.ReleaseYear)" class="dropdown-item">Release Year</a></li>
                    <li><a href="@FormatUrl(@ViewBag.Page, SortType.LastPlayed)" class="dropdown-item">Last Played</a></li>
                    <li><a href="@FormatUrl(@ViewBag.Page, SortType.LastAdded)" class="dropdown-item">Last Added</a></li>
                </ul>
            </li>
            <li>
            <p class="navbar-text">@ViewBag.FriendlySortType</p>
                </li>
        </ul>
    </div>
</div>
<div class="container">
    <ul class="thumbnails">
        @foreach (var item in Model) {     
            <li class="span3 thumbnail">
                <a href="#modalAlbumDetails_@Html.DisplayFor(model => item.AlbumID)" data-toggle="modal">
                    <img src="@Html.DisplayFor(model => item.ArtworkLocation)" width="180" height="180"/>
                </a>
                <div id="modalAlbumDetails_@Html.DisplayFor(model => item.AlbumID)" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-header">
                        <table>
                            <tr>
                                <td>
                                    <h3>@Html.DisplayFor(model => item.Artist)</h3>
                                    <p>@Html.DisplayFor(model => item.Name)</p>
                                </td>
                                <td>
                                    <img src="@Html.DisplayFor(model => item.ArtworkLocation)" width="60" height="60"/></td>
                            </tr>
                        </table>
                    </div>
                    <div class="modal-body">
                        <table>
                            <tr>
                                <td><strong>@Html.DisplayNameFor(model => model.Year)</strong></td>
                                <td class="table-data">@Html.DisplayFor(model => item.Year)</td>
                            </tr>
                            <tr>
                                <td><strong>@Html.DisplayNameFor(model => model.Genre)</strong></td>
                                <td class="table-data">@Html.DisplayFor(model => item.Genre)</td>
                            </tr>
                            <tr>
                                <td><strong>@Html.DisplayNameFor(model => model.PlayCount)</strong></td>
                                <td class="table-data">@Html.DisplayFor(model => item.PlayCount)</td>
                            </tr>
                            <tr>
                                <td><strong>@Html.DisplayNameFor(model => model.LastPlayed)</strong></td>
                                <td class="table-data">@Html.DisplayFor(model => item.LastPlayed)</td>
                            </tr>
                            <tr>
                                <td><strong>@Html.DisplayNameFor(model => model.DateAdded)</strong></td>
                                <td class="table-data">@Html.DisplayFor(model => item.DateAdded)</td>
                            </tr>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <a data-dismiss="modal" class="btn">Close</a>
                    </div>
                </div>
            </li>
        }
    </ul>
</div>
<div class="pagination pagination-centered">
    <ul>
        <li><a href="#" id="previous-page" data-currentpage="@ViewBag.Page" data-currentsort="@ViewBag.SortType">Prev</a></li>
        @foreach (var page in Enumerable.Range(1, ViewBag.NumberOfPages)) {
            <li><a href="Album?page=@page&sortType=@ViewBag.SortType" data-currentpage="@ViewBag.Page" id="page_@page">@page</a></li>
        }
        <li><a href="#" id="next-page" data-currentpage="@ViewBag.Page" data-currentsort="@ViewBag.SortType">Next</a></li>
    </ul>
</div>